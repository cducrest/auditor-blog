<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.8.1"/><meta name="description" content="Results of the Olympus DAO audit on Sherlock" data-gatsby-head="true"/><meta name="image" content="https://cducrest.github.io/auditor-blog/static/1787cb9164449ac705caf33048739784/a6c62/olympusDAO.jpg" data-gatsby-head="true"/><meta property="og:title" content="Olympus DAO audit result | cducrest Blog" data-gatsby-head="true"/><meta property="og:url" content="https://cducrest.github.io/auditor-blog/olympus-dao-audit-result" data-gatsby-head="true"/><meta property="og:description" content="Results of the Olympus DAO audit on Sherlock" data-gatsby-head="true"/><meta property="og:image" content="https://cducrest.github.io/auditor-blog/static/1787cb9164449ac705caf33048739784/a6c62/olympusDAO.jpg" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:image:alt" content="Results of the Olympus DAO audit on Sherlock" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta name="twitter:title" content="Olympus DAO audit result | cducrest Blog" data-gatsby-head="true"/><meta name="twitter:url" content="https://cducrest.github.io/auditor-blog/olympus-dao-audit-result" data-gatsby-head="true"/><meta name="twitter:description" content="Results of the Olympus DAO audit on Sherlock" data-gatsby-head="true"/><meta name="twitter:image" content="https://cducrest.github.io/auditor-blog/static/1787cb9164449ac705caf33048739784/a6c62/olympusDAO.jpg" data-gatsby-head="true"/><meta name="twitter:image:alt" content="Results of the Olympus DAO audit on Sherlock" data-gatsby-head="true"/><meta name="twitter:creator" content="@cducrest" data-gatsby-head="true"/><meta name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog" data-gatsby-head="true"/><link rel="sitemap" type="application/xml" href="/auditor-blog/sitemap-index.xml"/><link rel="manifest" href="/auditor-blog/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="192x192" href="/auditor-blog/android-chrome-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/auditor-blog/android-chrome-512x512.png"/><link rel="alternate" type="application/rss+xml" title="cducrest Blog" href="/auditor-blog/rss.xml"/><style data-emotion="css-global 1s7ffb4" data-gatsby-head="true">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-primary:#b794f4;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#8a9ab0;--theme-ui-colors-muted:#2d3748;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-highlightLineBg:rgba(255, 255, 255, 0.1);--theme-ui-colors-plain-color:#9CDCFE;--theme-ui-colors-plain-backgroundColor:#1E1E1E;--theme-ui-colors-comment-color:rgb(106, 153, 85);--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:rgb(0, 0, 128);--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:rgb(206, 145, 120);--theme-ui-colors-attr-value-color:rgb(206, 145, 120);--theme-ui-colors-punctuation-color:#808080;--theme-ui-colors-operator-color:rgb(212, 212, 212);--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:rgb(181, 206, 168);--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:rgb(156, 220, 254);--theme-ui-colors-constant-color:rgb(100, 102, 149);--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:rgb(181, 206, 168);--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:rgb(86, 156, 214);--theme-ui-colors-attr-name-color:rgb(156, 220, 254);--theme-ui-colors-selector-color:rgb(215, 186, 125);--theme-ui-colors-function-color:rgb(220, 220, 170);--theme-ui-colors-deleted-color:rgb(206, 145, 120);--theme-ui-colors-tag-color:rgb(86, 156, 214);--theme-ui-colors-function-variable-color:#6f42c1;--theme-ui-colors-builtin-color:rgb(86, 156, 214);--theme-ui-colors-changed-color:rgb(86, 156, 214);--theme-ui-colors-interpolation-punctuation-color:rgb(86, 156, 214);--theme-ui-colors-template-punctuation-color:rgb(206, 145, 120);--theme-ui-colors-class-name-color:rgb(78, 201, 176);--theme-ui-colors-char-color:rgb(209, 105, 105);color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#b794f4;--theme-ui-colors-secondary:#8a9ab0;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;--theme-ui-colors-highlightLineBg:rgba(255, 255, 255, 0.1);--theme-ui-colors-plain-color:#9CDCFE;--theme-ui-colors-plain-backgroundColor:#1E1E1E;--theme-ui-colors-prolog-color:rgb(0, 0, 128);--theme-ui-colors-comment-color:rgb(106, 153, 85);--theme-ui-colors-builtin-color:rgb(86, 156, 214);--theme-ui-colors-changed-color:rgb(86, 156, 214);--theme-ui-colors-keyword-color:rgb(86, 156, 214);--theme-ui-colors-interpolation-punctuation-color:rgb(86, 156, 214);--theme-ui-colors-number-color:rgb(181, 206, 168);--theme-ui-colors-inserted-color:rgb(181, 206, 168);--theme-ui-colors-constant-color:rgb(100, 102, 149);--theme-ui-colors-attr-name-color:rgb(156, 220, 254);--theme-ui-colors-variable-color:rgb(156, 220, 254);--theme-ui-colors-deleted-color:rgb(206, 145, 120);--theme-ui-colors-string-color:rgb(206, 145, 120);--theme-ui-colors-attr-value-color:rgb(206, 145, 120);--theme-ui-colors-template-punctuation-color:rgb(206, 145, 120);--theme-ui-colors-selector-color:rgb(215, 186, 125);--theme-ui-colors-tag-color:rgb(86, 156, 214);--theme-ui-colors-punctuation-color:#808080;--theme-ui-colors-operator-color:rgb(212, 212, 212);--theme-ui-colors-function-color:rgb(220, 220, 170);--theme-ui-colors-class-name-color:rgb(78, 201, 176);--theme-ui-colors-char-color:rgb(209, 105, 105);}</style><style data-emotion="css-global 1w2pyfm" data-gatsby-head="true">*{box-sizing:border-box;}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}body{margin:0;}</style><title data-gatsby-head="true">Olympus DAO audit result | cducrest Blog</title><link rel="icon" type="image/png" sizes="32x32" href="/auditor-blog/favicon-32x32.png" data-gatsby-head="true"/><link rel="icon" type="image/png" sizes="16x16" href="/auditor-blog/favicon-16x16.png" data-gatsby-head="true"/><link rel="apple-touch-icon" sizes="180x180" href="/auditor-blog/apple-touch-icon.png" data-gatsby-head="true"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global 1s7ffb4">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-primary:#b794f4;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#8a9ab0;--theme-ui-colors-muted:#2d3748;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-highlightLineBg:rgba(255, 255, 255, 0.1);--theme-ui-colors-plain-color:#9CDCFE;--theme-ui-colors-plain-backgroundColor:#1E1E1E;--theme-ui-colors-comment-color:rgb(106, 153, 85);--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:rgb(0, 0, 128);--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:rgb(206, 145, 120);--theme-ui-colors-attr-value-color:rgb(206, 145, 120);--theme-ui-colors-punctuation-color:#808080;--theme-ui-colors-operator-color:rgb(212, 212, 212);--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:rgb(181, 206, 168);--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:rgb(156, 220, 254);--theme-ui-colors-constant-color:rgb(100, 102, 149);--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:rgb(181, 206, 168);--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:rgb(86, 156, 214);--theme-ui-colors-attr-name-color:rgb(156, 220, 254);--theme-ui-colors-selector-color:rgb(215, 186, 125);--theme-ui-colors-function-color:rgb(220, 220, 170);--theme-ui-colors-deleted-color:rgb(206, 145, 120);--theme-ui-colors-tag-color:rgb(86, 156, 214);--theme-ui-colors-function-variable-color:#6f42c1;--theme-ui-colors-builtin-color:rgb(86, 156, 214);--theme-ui-colors-changed-color:rgb(86, 156, 214);--theme-ui-colors-interpolation-punctuation-color:rgb(86, 156, 214);--theme-ui-colors-template-punctuation-color:rgb(206, 145, 120);--theme-ui-colors-class-name-color:rgb(78, 201, 176);--theme-ui-colors-char-color:rgb(209, 105, 105);color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#b794f4;--theme-ui-colors-secondary:#8a9ab0;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;--theme-ui-colors-highlightLineBg:rgba(255, 255, 255, 0.1);--theme-ui-colors-plain-color:#9CDCFE;--theme-ui-colors-plain-backgroundColor:#1E1E1E;--theme-ui-colors-prolog-color:rgb(0, 0, 128);--theme-ui-colors-comment-color:rgb(106, 153, 85);--theme-ui-colors-builtin-color:rgb(86, 156, 214);--theme-ui-colors-changed-color:rgb(86, 156, 214);--theme-ui-colors-keyword-color:rgb(86, 156, 214);--theme-ui-colors-interpolation-punctuation-color:rgb(86, 156, 214);--theme-ui-colors-number-color:rgb(181, 206, 168);--theme-ui-colors-inserted-color:rgb(181, 206, 168);--theme-ui-colors-constant-color:rgb(100, 102, 149);--theme-ui-colors-attr-name-color:rgb(156, 220, 254);--theme-ui-colors-variable-color:rgb(156, 220, 254);--theme-ui-colors-deleted-color:rgb(206, 145, 120);--theme-ui-colors-string-color:rgb(206, 145, 120);--theme-ui-colors-attr-value-color:rgb(206, 145, 120);--theme-ui-colors-template-punctuation-color:rgb(206, 145, 120);--theme-ui-colors-selector-color:rgb(215, 186, 125);--theme-ui-colors-tag-color:rgb(86, 156, 214);--theme-ui-colors-punctuation-color:#808080;--theme-ui-colors-operator-color:rgb(212, 212, 212);--theme-ui-colors-function-color:rgb(220, 220, 170);--theme-ui-colors-class-name-color:rgb(78, 201, 176);--theme-ui-colors-char-color:rgb(209, 105, 105);}</style><style data-emotion="css-global 1w2pyfm">*{box-sizing:border-box;}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global h7esfd">*{box-sizing:inherit;}html{-webkit-text-size-adjust:100%;}img{border-style:none;}pre{font-family:monospace;font-size:1em;}[hidden]{display:none;}::selection{background-color:var(--theme-ui-colors-text);color:var(--theme-ui-colors-background);}a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:text;}</style><style data-emotion="css 1gq7j3t">.css-1gq7j3t{border:0;clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1gq7j3t:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading);color:var(--theme-ui-colors-background);z-index:1;width:auto;height:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1gq7j3t">Skip to content</a><style data-emotion="css 10f80pj">.css-10f80pj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width: 640px){.css-10f80pj{padding:2rem;}}</style><div class="css-10f80pj"><style data-emotion="css egutgn">.css-egutgn{margin-bottom:4rem;}@media screen and (min-width: 640px){.css-egutgn{margin-bottom:8rem;}}</style><header class="css-egutgn"><style data-emotion="css 1xwyizx">.css-1xwyizx{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><style data-emotion="css 1pbimyf">.css-1pbimyf{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><div class="css-1pbimyf"><style data-emotion="css uxjqfw">.css-uxjqfw{color:var(--theme-ui-colors-heading);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="cducrest Blog - Back to home" class="css-uxjqfw" href="/auditor-blog"><style data-emotion="css 19i8ga6">.css-19i8ga6{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.5rem;}@media screen and (min-width: 640px){.css-19i8ga6{font-size:1.875rem;}}</style><div class="css-19i8ga6">cducrest Blog</div></a></div><style data-emotion="css fp1v3n">.css-fp1v3n{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary);-webkit-box-flex-flow:wrap;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-fp1v3n a{color:var(--theme-ui-colors-secondary);}.css-fp1v3n a:hover{color:var(--theme-ui-colors-heading);}</style><div class="css-fp1v3n"><style data-emotion="css 1lx5s1f">.css-1lx5s1f{font-size:1rem;}.css-1lx5s1f a:not(:last-of-type){margin-right:1rem;}@media screen and (min-width: 640px){.css-1lx5s1f{font-size:18px;}}.css-1lx5s1f .active{color:var(--theme-ui-colors-heading);}</style><nav class="css-1lx5s1f"><style data-emotion="css bpdkdn">.css-bpdkdn{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-bpdkdn:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-bpdkdn" href="/auditor-blog/blog">Blog</a><a class="css-bpdkdn" href="/auditor-blog/about">About</a></nav><style data-emotion="css 45ghvz">.css-45ghvz{font-size:1rem;}.css-45ghvz a:not(:first-of-type){margin-left:1rem;}@media screen and (min-width: 640px){.css-45ghvz{font-size:18px;}}</style><div class="css-45ghvz"><style data-emotion="css aizfxq">.css-aizfxq{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-aizfxq:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://twitter.com/Oizo____" class="css-aizfxq">Twitter</a><a href="https://github.com/cducrest" class="css-aizfxq">Github</a></div></div></header><style data-emotion="css 1w9aswf">.css-1w9aswf .prism-code{font-size:1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-1w9aswf .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-1w9aswf .prism-code{font-size:1.25rem;}}.css-1w9aswf .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1w9aswf .gatsby-highlight[data-language='none'] .code-content,.css-1w9aswf .gatsby-highlight[data-language=''] .code-content{padding-top:1rem;}.css-1w9aswf .code-content{padding:2rem 1rem 1rem 1rem;color:var(--theme-ui-colors-plain-color);background-color:var(--theme-ui-colors-plain-backgroundColor);}.css-1w9aswf .token{display:inline-block;}.css-1w9aswf p>code,.css-1w9aswf li>code{background-color:var(--theme-ui-colors-muted);color:var(--theme-ui-colors-heading);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:4px;font-size:0.95em;}.css-1w9aswf .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;border-radius:4px;overflow:hidden;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1w9aswf .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1w9aswf .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1w9aswf .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1w9aswf .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1w9aswf .gatsby-highlight pre code{float:left;min-width:100%;}.css-1w9aswf .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 4px 4px;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.035rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;}.css-1w9aswf .gatsby-highlight pre[class~="language-golang"]:before,.css-1w9aswf .gatsby-highlight pre[class~="language-go"]:before{content:"go";background:#79d4fd;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-javascript"]:before,.css-1w9aswf .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1w9aswf .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1w9aswf .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1w9aswf .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1w9aswf .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-1w9aswf .gatsby-highlight pre[class~="language-py"]:before,.css-1w9aswf .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-1w9aswf .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1w9aswf .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1w9aswf .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1w9aswf .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1w9aswf .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1w9aswf .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1w9aswf .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1w9aswf .gatsby-highlight pre[class~='language-json']:before,.css-1w9aswf .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1w9aswf .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1w9aswf .gatsby-highlight>code[class*="language-"],.css-1w9aswf .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1w9aswf .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1w9aswf .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-1w9aswf .gatsby-highlight pre::-webkit-scrollbar-track{background:var(--theme-ui-colors-muted);}.css-1w9aswf .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1w9aswf .code-title{background-color:var(--theme-ui-colors-muted);color:var(--theme-ui-colors-text);font-size:1rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";}.css-1w9aswf .token-line{padding-right:1rem;}.css-1w9aswf .highlight-line{border-left:4px solid rgb(2, 155, 206);}.css-1w9aswf .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1w9aswf .footnotes{border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:0.5rem;margin-top:4rem;overflow:auto;}.css-1w9aswf .footnotes .sr-only{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><style data-emotion="css 1wlcpc3">.css-1wlcpc3{box-sizing:border-box;margin:0;min-width:0;}.css-1wlcpc3 .prism-code{font-size:1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-1wlcpc3 .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-1wlcpc3 .prism-code{font-size:1.25rem;}}.css-1wlcpc3 .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1wlcpc3 .gatsby-highlight[data-language='none'] .code-content,.css-1wlcpc3 .gatsby-highlight[data-language=''] .code-content{padding-top:1rem;}.css-1wlcpc3 .code-content{padding:2rem 1rem 1rem 1rem;color:var(--theme-ui-colors-plain-color);background-color:var(--theme-ui-colors-plain-backgroundColor);}.css-1wlcpc3 .token{display:inline-block;}.css-1wlcpc3 p>code,.css-1wlcpc3 li>code{background-color:var(--theme-ui-colors-muted);color:var(--theme-ui-colors-heading);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:4px;font-size:0.95em;}.css-1wlcpc3 .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;border-radius:4px;overflow:hidden;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1wlcpc3 .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1wlcpc3 .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1wlcpc3 .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1wlcpc3 .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1wlcpc3 .gatsby-highlight pre code{float:left;min-width:100%;}.css-1wlcpc3 .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 4px 4px;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.035rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-weight:600;}.css-1wlcpc3 .gatsby-highlight pre[class~="language-golang"]:before,.css-1wlcpc3 .gatsby-highlight pre[class~="language-go"]:before{content:"go";background:#79d4fd;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-javascript"]:before,.css-1wlcpc3 .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1wlcpc3 .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-py"]:before,.css-1wlcpc3 .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-1wlcpc3 .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1wlcpc3 .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1wlcpc3 .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1wlcpc3 .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1wlcpc3 .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1wlcpc3 .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1wlcpc3 .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1wlcpc3 .gatsby-highlight pre[class~='language-json']:before,.css-1wlcpc3 .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1wlcpc3 .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1wlcpc3 .gatsby-highlight>code[class*="language-"],.css-1wlcpc3 .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1wlcpc3 .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1wlcpc3 .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-1wlcpc3 .gatsby-highlight pre::-webkit-scrollbar-track{background:var(--theme-ui-colors-muted);}.css-1wlcpc3 .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1wlcpc3 .code-title{background-color:var(--theme-ui-colors-muted);color:var(--theme-ui-colors-text);font-size:1rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";}.css-1wlcpc3 .token-line{padding-right:1rem;}.css-1wlcpc3 .highlight-line{border-left:4px solid rgb(2, 155, 206);}.css-1wlcpc3 .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1wlcpc3 .footnotes{border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:0.5rem;margin-top:4rem;overflow:auto;}.css-1wlcpc3 .footnotes .sr-only{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><main id="skip-nav" class=" css-1wlcpc3"><style data-emotion="css w1q1hj">.css-w1q1hj{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-w1q1hj{font-size:2.25rem;}}@media screen and (min-width: 768px){.css-w1q1hj{font-size:2.25rem;}}@media screen and (min-width: 1024px){.css-w1q1hj{font-size:3rem;}}</style><h1 class="css-w1q1hj">Olympus DAO audit result</h1><style data-emotion="css 15ce8we">.css-15ce8we{color:var(--theme-ui-colors-secondary);margin-top:1rem;font-size:1rem;}.css-15ce8we a{color:var(--theme-ui-colors-secondary);}@media screen and (min-width: 640px){.css-15ce8we{font-size:1rem;}}@media screen and (min-width: 768px){.css-15ce8we{font-size:1.25rem;}}</style><p class="css-15ce8we"><time>09.05.2023</time> — <a class="css-bpdkdn" href="/auditor-blog/tags/audit-result">Audit result</a>, <a class="css-bpdkdn" href="/auditor-blog/tags/sherlock">Sherlock</a> — <span>8<!-- --> min read</span></p><style data-emotion="css 1mae7sn">.css-1mae7sn{margin-top:4rem;margin-bottom:4rem;}.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;border-radius:4px;box-shadow:rgba(0, 0, 0, 0.1) 0px 16px 16px 0px,rgba(0, 0, 0, 0.1) 0px 8px 8px 0px,rgba(0, 0, 0, 0.1) 0px 4px 4px 0px;}@media screen and (min-width: 640px){.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width: 768px){.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}.css-1mae7sn .gatsby-resp-image-wrapper .gatsby-resp-image-image{border-radius:4px;}.css-1mae7sn figure{margin:0;}.css-1mae7sn figure img{border-radius:4px;box-shadow:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);max-width:100%;}</style><section class="css-1mae7sn"><span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBA//EABYBAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABqtqo4hgAH//EABoQAQACAwEAAAAAAAAAAAAAAAECEQADIDL/2gAIAQEAAQUCC1ihmv0UR4//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAABBAMAAAAAAAAAAAAAAAAhAAECECAiUf/aAAgBAQAGPwIWQpbNzH//xAAbEAEAAgIDAAAAAAAAAAAAAAABESEAECBRYf/aAAgBAQABPyFABK5KKTxmNILgIk4LcWh3x//aAAwDAQACAAMAAAAQcDDD/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHRABAQABBAMAAAAAAAAAAAAAAREhABAxYSBBkf/aAAgBAQABPxBMiIB70+cjFOnc42yRKJ4pMd6lILkEUafMeP8A/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="olympusDAO"
        title=""
        src="/auditor-blog/static/1787cb9164449ac705caf33048739784/27ec1/olympusDAO.jpg"
        srcset="/auditor-blog/static/1787cb9164449ac705caf33048739784/46946/olympusDAO.jpg 240w,
/auditor-blog/static/1787cb9164449ac705caf33048739784/27ec1/olympusDAO.jpg 400w"
        sizes="(max-width: 400px) 100vw, 400px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></span>
<style data-emotion="css vehe2z">.css-vehe2z{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-vehe2z{font-size:1rem;}}@media screen and (min-width: 768px){.css-vehe2z{font-size:1.25rem;}}</style><style data-emotion="css z0logh">.css-z0logh{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-z0logh{font-size:1rem;}}@media screen and (min-width: 768px){.css-z0logh{font-size:1.25rem;}}@media screen and (min-width: 640px){.css-z0logh{font-size:1rem;}}@media screen and (min-width: 768px){.css-z0logh{font-size:1.25rem;}}</style><p class="css-z0logh">OlympusDAO intends to create a non-pegged stable coin called OHM. In this audit, we were interested by what they called the SingleSidedLiquidityVault.
The idea behind it is to create a vault bound to an AMM liquidity pool (e.g. Balancer), that lets users deposit pair tokens (e.g. wstETH).
The vault will then mint OHM tokens matching the USD value of pair tokens deposited by the user and provide liquidity to the pool in a 50/50 OHM/pair token value split.
The vault can deposit the LP tokens it gets from the pool and stake them to farm reward (e.g. in Aura).</p>
<p class="css-z0logh">The code was reviewed as part of the <style data-emotion="css 1d2wwf6">.css-1d2wwf6{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1d2wwf6:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css 1diwg7s">.css-1diwg7s{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1diwg7s:hover{-webkit-text-decoration:underline;text-decoration:underline;}.css-1diwg7s:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://app.sherlock.xyz/audits/contests/50" class="css-1diwg7s">Sherlock contest</a>.
I ranked 4th out of 154 participants in this audit. I found 3 high and 2 medium vulnerabilities, I present my findings here.</p>
<style data-emotion="css tcuklq">.css-tcuklq{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-tcuklq{font-size:2.25rem;}}@media screen and (min-width: 768px){.css-tcuklq{font-size:2.25rem;}}@media screen and (min-width: 1024px){.css-tcuklq{font-size:3rem;}}</style><style data-emotion="css cha28j">.css-cha28j{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading);font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-cha28j{font-size:2.25rem;}}@media screen and (min-width: 768px){.css-cha28j{font-size:2.25rem;}}@media screen and (min-width: 1024px){.css-cha28j{font-size:3rem;}}@media screen and (min-width: 640px){.css-cha28j{font-size:2.25rem;}}@media screen and (min-width: 768px){.css-cha28j{font-size:2.25rem;}}@media screen and (min-width: 1024px){.css-cha28j{font-size:3rem;}}</style><h1 class="css-cha28j">High: cachedUserRewards is never cleaned</h1>
<style data-emotion="css 90ntna">.css-90ntna{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-90ntna{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-90ntna{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-90ntna{font-size:2.25rem;}}</style><style data-emotion="css 1h962gv">.css-1h962gv{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-1h962gv{font-size:2.25rem;}}@media screen and (min-width: 640px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-1h962gv{font-size:2.25rem;}}</style><h2 class="css-1h962gv">Summary</h2>
<p class="css-z0logh">The system uses <code class="css-zezy6m">cachedUserRewards</code> as a cache of the amount of reward tokens a user was entitled to but did not withdraw. However, this value is never reset to 0 so a user with cached reward will receive these rewards on withdraws when a userRewardDebts is reset to 0.</p>
<h2 class="css-1h962gv">Vulnerability Detail</h2>
<p class="css-z0logh">In <code class="css-zezy6m">_withdrawUpdateRewardState</code>, if <code class="css-zezy6m">claim_ == false</code>, the value of <code class="css-zezy6m">userRewardDebts</code> for the user will not be updated and the check <code class="css-zezy6m">rewardDebtDiff &gt; userRewardDebts[msg.sender][rewardToken.token]</code> may pass (line 583). This will set the <code class="css-zezy6m">userRewardDebts</code> to 0 and increase <code class="css-zezy6m">cachedUserRewards</code> by its difference to <code class="css-zezy6m">rewardDebtDiff</code>.</p>
<p class="css-z0logh">On the next withdraw, the user will be entitled to receive its pending rewards as well as the cached reward based on the value of <code class="css-zezy6m">cachedUserRewards</code>. The value of <code class="css-zezy6m">cachedUserRewards</code> is not lowered afterwhile, that is not a problem in itself because <code class="css-zezy6m">userRewardDebts</code> will be increased anyway by the amount of reward token sent, so it will take into account the cached value.</p>
<p class="css-z0logh">However, if the user repeats the operation multiple times, the value of <code class="css-zezy6m">cachedUserRewards</code> will keep on growing and never lowers. After two times accruing cached rewards, and after the userRewardDebts is reset to 0 (line 584), the user will be able to claim rewards using <code class="css-zezy6m">claimRewards()</code> and receive reward equal to the amount of token cached both the first and the second time.</p>
<p class="css-z0logh">Example:</p>
<style data-emotion="css rc057y">.css-rc057y li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-rc057y li{font-size:1rem;}}@media screen and (min-width: 768px){.css-rc057y li{font-size:1.25rem;}}</style><style data-emotion="css 15vy6y4">.css-15vy6y4 li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-15vy6y4 li{font-size:1rem;}}@media screen and (min-width: 768px){.css-15vy6y4 li{font-size:1.25rem;}}.css-15vy6y4 li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-15vy6y4 li{font-size:1rem;}}@media screen and (min-width: 768px){.css-15vy6y4 li{font-size:1.25rem;}}</style><ul class="css-15vy6y4">
<li class="css-zezy6m">Users deposits pair tokens</li>
<li class="css-zezy6m">They are entitled to a reward</li>
<li class="css-zezy6m">They withdraw 10% of their deposit with <code class="css-zezy6m">claim_ = false</code></li>
<li class="css-zezy6m">This increases <code class="css-zezy6m">cachedUserRewards</code> by 10% of their entitled reward</li>
<li class="css-zezy6m">They call <code class="css-zezy6m">claimRewards()</code>, claiming all their rewards and adding the reward debt to <code class="css-zezy6m">userRewardDebts</code></li>
<li class="css-zezy6m">They wait for reward to accrue</li>
<li class="css-zezy6m">They withdraw 20% of their deposit with <code class="css-zezy6m">claim_ = false</code></li>
<li class="css-zezy6m">Their <code class="css-zezy6m">userRewardDebts</code> is reset to 0</li>
<li class="css-zezy6m">Their <code class="css-zezy6m">cachedUserRewards</code> is increased by 20% of their entitled reward on top of the previous 10%</li>
<li class="css-zezy6m">They call <code class="css-zezy6m">claimRewards()</code>, claiming all their pending rewards + cached rewards of 20% + cached rewards of 10%</li>
</ul>
<p class="css-z0logh">They received the initial 10% cached rewards twice.</p>
<h2 class="css-1h962gv">Impact</h2>
<p class="css-z0logh">Attackers can drain reward tokens from the contract.</p>
<h2 class="css-1h962gv">Code Snippet</h2>
<p class="css-z0logh">cachedUserRewards is increased but never lowered:</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L583-L590" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L583-L590</a></p>
<p class="css-z0logh">cachedUserRewards are used in the calculation for amount of reward token the user is entitled to:</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L354-L372" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L354-L372</a></p>
<h2 class="css-1h962gv">Recommendation</h2>
<p class="css-z0logh">Reset the value of <code class="css-zezy6m">cachedUserRewards</code> on withdraw instead of adding it to the <code class="css-zezy6m">userRewardDebts</code> value.</p>
<style data-emotion="css igtsiw">.css-igtsiw{background-color:var(--theme-ui-colors-muted);border:0;height:1px;margin:1rem;margin-left:0;margin-right:0;}</style><style data-emotion="css 1ve732v">.css-1ve732v{background-color:var(--theme-ui-colors-muted);border:0;height:1px;margin:1rem;margin-left:0;margin-right:0;background-color:var(--theme-ui-colors-muted);border:0;height:1px;margin:1rem;margin-left:0;margin-right:0;}</style><hr class="css-1ve732v"/>
<h1 class="css-cha28j">High: Incorrect reward tracking / calculation</h1>
<h2 class="css-1h962gv">Summary</h2>
<p class="css-z0logh">The function that calculates the amount of reward token to receive <code class="css-zezy6m">internalRewardsForToken()</code> divides the end result by <code class="css-zezy6m">10**18</code> which is inconsistent with how the result is treated.</p>
<h2 class="css-1h962gv">Vulnerability Detail</h2>
<p class="css-z0logh">The result returned by <code class="css-zezy6m">internalRewardsForToken()</code> is <code class="css-zezy6m">(cachedUserRewards[user_][rewardToken.token] + (lpPositions[user_] * accumulatedRewardsPerShare) - userRewardDebts[user_][rewardToken.token]) / 1e18</code>. The lp token uses 18 decimals and <code class="css-zezy6m">accumulatedRewardsPerShare</code> is expressed in power of 18 as suggested by <code class="css-zezy6m">accumulatedRewardsPerShare += (totalRewards * 1e18) / totalLP</code>.</p>
<p class="css-z0logh">This result is used by <code class="css-zezy6m">_claimInternalRewards</code> which adds it to <code class="css-zezy6m">userRewardDebts[msg.sender][rewardToken]</code>. The values of <code class="css-zezy6m">userRewardDebts</code> and <code class="css-zezy6m">cachedUserRewards</code> are then transferred from one to the other in <code class="css-zezy6m">_withdrawUpdateRewardState</code> under certain circumstances (line 585), which means they should have the same dimension (in terms of power of 10).</p>
<p class="css-z0logh">However, as we saw the value of <code class="css-zezy6m">cachedUserRewards</code> for the user is divided by <code class="css-zezy6m">1e18</code> in the calculation above, which means they cannot have the same dimension.</p>
<p class="css-z0logh">Additionally the amount of tokens transferred by <code class="css-zezy6m">_claimInternalRewards()</code> should take into account the full cache and not <code class="css-zezy6m">cachedUserRewards / 1e18</code></p>
<h2 class="css-1h962gv">Impact</h2>
<p class="css-z0logh">The cached user reward have almost no impact on the reward token that should be withdrawn by the user. The users will receive less reward token than they should if they use the cache and do not withdraw their rewards on each withdraw from the vault.</p>
<h2 class="css-1h962gv">Code Snippet</h2>
<p class="css-z0logh">internalRewardsForToken divides the whole result by <code class="css-zezy6m">10**18</code>:</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L354-L372" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L354-L372</a></p>
<p class="css-z0logh">It is used in _claimInternalRewards:</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L623-L634" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L623-L634</a></p>
<p class="css-z0logh">cachedUserRewards and userRewardDebts should be comparable:</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L583-L590" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L583-L590</a></p>
<h2 class="css-1h962gv">Recommendation</h2>
<p class="css-z0logh">Move the division by 10**18.</p>
<div class="gatsby-highlight" data-language="diff"><pre class="prism-code language-diff" data-linenumber="true"><style data-emotion="css ce1lkk">.css-ce1lkk{background-color:var(--theme-ui-colors-background);border:none;color:var(--theme-ui-colors-text);cursor:pointer;font-size:14px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";letter-spacing:0.025rem;-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;position:absolute;right:0;z-index:1;border-radius:0 0 0 0.25rem;padding:0.25rem 0.6rem;}@media screen and (min-width: 640px){.css-ce1lkk{font-size:14px;}}@media screen and (min-width: 768px){.css-ce1lkk{font-size:16px;}}.css-ce1lkk[disabled]{cursor:not-allowed;}.css-ce1lkk:not([disabled]):hover{background-color:var(--theme-ui-colors-primary);color:var(--theme-ui-colors-white);}</style><button type="button" name="copy code to clipboard" class="code-copy-button css-ce1lkk">Copy<style data-emotion="css 15vf505">.css-15vf505{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="code-content language-diff"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">function internalRewardsForToken(uint256 id_, address user_) public view returns (uint256) {</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       InternalRewardToken memory rewardToken = internalRewardTokens[id_];</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       uint256 lastRewardTime = rewardToken.lastRewardTime;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       uint256 accumulatedRewardsPerShare = rewardToken.accumulatedRewardsPerShare;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token unchanged line"></span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       if (block.timestamp &gt; lastRewardTime &amp;&amp; totalLP != 0) {</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">           uint256 timeDiff = block.timestamp - lastRewardTime;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">           uint256 totalRewards = timeDiff * rewardToken.rewardsPerSecond;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token unchanged line"></span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">           // This correctly uses 1e18 because the LP tokens of all major DEXs have 18 decimals</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">           accumulatedRewardsPerShare += (totalRewards * 1e18) / totalLP;</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       }</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token unchanged line"></span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       // This correctly uses 1e18 because the LP tokens of all major DEXs have 18 decimals</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(173, 219, 103);font-style:italic">+</span><span class="token inserted-sign inserted line" style="color:rgb(173, 219, 103);font-style:italic">        uint256 totalAccumulatedRewards = (lpPositions[user_] * accumulatedRewardsPerShare)  / 1e18 -</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token inserted-sign inserted line" style="color:rgb(173, 219, 103);font-style:italic"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(173, 219, 103);font-style:italic">+</span><span class="token inserted-sign inserted line" style="color:rgb(173, 219, 103);font-style:italic">            userRewardDebts[user_][rewardToken.token];</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token inserted-sign inserted line" style="color:rgb(173, 219, 103);font-style:italic"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(173, 219, 103);font-style:italic">+</span><span class="token inserted-sign inserted line" style="color:rgb(173, 219, 103);font-style:italic"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token inserted-sign inserted line" style="color:rgb(173, 219, 103);font-style:italic"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(173, 219, 103);font-style:italic">+</span><span class="token inserted-sign inserted line" style="color:rgb(173, 219, 103);font-style:italic">        return cachedUserRewards[user_][rewardToken.token] + totalAccumulatedRewards</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token inserted-sign inserted line" style="color:rgb(173, 219, 103);font-style:italic"></span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgba(239, 83, 80, 0.56);font-style:italic">-</span><span class="token deleted-sign deleted line" style="color:rgba(239, 83, 80, 0.56);font-style:italic">        uint256 totalAccumulatedRewards = (lpPositions[user_] * accumulatedRewardsPerShare) -</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token deleted-sign deleted line" style="color:rgba(239, 83, 80, 0.56);font-style:italic"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgba(239, 83, 80, 0.56);font-style:italic">-</span><span class="token deleted-sign deleted line" style="color:rgba(239, 83, 80, 0.56);font-style:italic">            userRewardDebts[user_][rewardToken.token];</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token deleted-sign deleted line" style="color:rgba(239, 83, 80, 0.56);font-style:italic"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgba(239, 83, 80, 0.56);font-style:italic">-</span><span class="token deleted-sign deleted line" style="color:rgba(239, 83, 80, 0.56);font-style:italic"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token deleted-sign deleted line" style="color:rgba(239, 83, 80, 0.56);font-style:italic"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgba(239, 83, 80, 0.56);font-style:italic">-</span><span class="token deleted-sign deleted line" style="color:rgba(239, 83, 80, 0.56);font-style:italic">        return (cachedUserRewards[user_][rewardToken.token] + totalAccumulatedRewards) / 1e18;</span></div></code></pre></div>
<hr class="css-1ve732v"/>
<h1 class="css-cha28j">High: Pool withdraw vulnerable to flash loan</h1>
<h2 class="css-1h962gv">Summary</h2>
<p class="css-z0logh">The function from <code class="css-zezy6m">WstethLiquidityVault</code> to withdraw from the pool will exit the the Balancer pool and get OHM / wstETH in proportion to the current pool balances. If the withdrawer flash loans from the pool before, they can impact the proportion of OHM / wstETH received.</p>
<h2 class="css-1h962gv">Vulnerability Detail</h2>
<p class="css-z0logh">As the <code class="css-zezy6m">withdraw()</code> function from <code class="css-zezy6m">SingleSidedLiquidityVault</code> will repay (burn) the OHM token to the protocol and only send the pair token (wstETH) to the user, the user is incentivized to flash loan OHM from the pool so he receives more pair token (wstETH).</p>
<h2 class="css-1h962gv">Impact</h2>
<p class="css-z0logh">This attack vector is limited by the <code class="css-zezy6m">_isPoolSafe()</code> function called at the beginning of <code class="css-zezy6m">withdraw()</code> which checks that the on-chain pool price is not more than <code class="css-zezy6m">THRESHOLD</code> away from the oracle price. Depending on the value of <code class="css-zezy6m">THRESHOLD</code>, the impact is more or less severe. If <code class="css-zezy6m">THRESHOLD</code> represents 1%, then the user will be able to get 1% more tokens out of the withdraw than they should.</p>
<p class="css-z0logh">An attacker could repeatedly deposit / flash loan / withdraw / reimburse flash loan to make a profit until the price of the pool becomes naturally too far from the oracle price. The attacker can then sell their gained pair tokens which could impact the oracle price to lower the price of pair token and attack again.</p>
<h2 class="css-1h962gv">Code Snippet</h2>
<p class="css-z0logh"><code class="css-zezy6m">_withdraw</code> in <code class="css-zezy6m">WstethLiquidityVault</code></p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/WstethLiquidityVault.sol#L179" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/WstethLiquidityVault.sol#L179</a></p>
<p class="css-z0logh"><code class="css-zezy6m">withdraw()</code> in <code class="css-zezy6m">SingleSidedLiquidityVault</code>, calls <code class="css-zezy6m">_isPoolSafe()</code> and <code class="css-zezy6m">_withdraw()</code>, then pays out only pairToken</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L252-L285" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L252-L285</a></p>
<p class="css-z0logh"><code class="css-zezy6m">_isPoolSafe()</code> uses oracle and threshold:</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L411-L421" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L411-L421</a></p>
<h2 class="css-1h962gv">Recommendation</h2>
<p class="css-z0logh">Use <code class="css-zezy6m">_valueCollateral()</code> to withdraw from the pool in a 50/50 usd value split based on oracle price and send out pair token to withdrawer instead of relying on pool balances.</p>
<hr class="css-1ve732v"/>
<h1 class="css-cha28j">Medium: removeInternalRewardToken does not clean storage value for users</h1>
<h2 class="css-1h962gv">Summary</h2>
<p class="css-z0logh">The function <code class="css-zezy6m">removeInternalRewardToken()</code> deletes an internal reward token from the list of reward tokens. However the values of <code class="css-zezy6m">userRewardDebts</code> and <code class="css-zezy6m">cachedUserRewards</code> for the token are still kept in storage.</p>
<h2 class="css-1h962gv">Vulnerability Detail</h2>
<p class="css-z0logh">If the token is added once again in the future, we could easily have inconsistencies with the leftover storage values concerning the users. As an example if the token is added again it will have <code class="css-zezy6m">accumulatedRewardsPerShare == 0</code> while some users might have <code class="css-zezy6m">userRewardDebts</code> set to a high value. These users may not be able to accumulate rewards in the future for this token.</p>
<h2 class="css-1h962gv">Impact</h2>
<p class="css-z0logh">If reward tokens are added / removed / added again, accounting will most likely be broken for some users. This is a problem even if the protocol does not intend to add / remove / add tokens if they unintentionally remove the wrong reward token from a vault, there will be no way for recovery.</p>
<h2 class="css-1h962gv">Code Snippet</h2>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L674-L703" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L674-L703</a></p>
<h2 class="css-1h962gv">Recommendation</h2>
<p class="css-z0logh">Let the function <code class="css-zezy6m">addInternalRewardToken</code> to provide a value for <code class="css-zezy6m">accumulatedRewardsPerShare</code> or loop through user data and delete it (should be fine gas-wise because it&#x27;s cleaning storage so getting gas refunded).</p>
<hr class="css-1ve732v"/>
<h1 class="css-cha28j">Medium: Adding reward token with future timestamp may break vault</h1>
<h2 class="css-1h962gv">Summary</h2>
<p class="css-z0logh">The vault has the possibility to add internal reward token with a timestamp in the future. Doing so will make accumulation of internal rewards fail due to underflow.</p>
<h2 class="css-1h962gv">Vulnerability Detail</h2>
<p class="css-z0logh">The function to accumulate internal rewards calculates <code class="css-zezy6m">uint256 timeDiff = block.timestamp - rewardToken.lastRewardTime;</code> which will revert if <code class="css-zezy6m">rewardToken.lastRewardTime</code> is in the future.</p>
<p class="css-z0logh">This function is called in <code class="css-zezy6m">_depositUpdateRewardState()</code> which is called among the first steps of <code class="css-zezy6m">deposit()</code> and in <code class="css-zezy6m">_withdrawUpdateRewardState</code> called among the first steps of <code class="css-zezy6m">withdraw()</code>.</p>
<h2 class="css-1h962gv">Impact</h2>
<p class="css-z0logh">Adding an internal token with a timestamp in the future will lock the vault until that timestamp is reached or the reward token is removed.</p>
<h2 class="css-1h962gv">Code Snippet</h2>
<p class="css-z0logh">addInternalRewardToken allows lastRewardTime to be in the future:</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L674-L688" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L674-L688</a></p>
<p class="css-z0logh">underflow in _accumulateInternalRewards:</p>
<p class="css-z0logh"><a href="https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L472" class="css-1diwg7s">https://github.com/sherlock-audit/2023-02-olympus/blob/main/src/policies/lending/abstracts/SingleSidedLiquidityVault.sol#L472</a></p>
<h2 class="css-1h962gv">Recommendation</h2>
<p class="css-z0logh">Check for future timestamp and assign a reward of 0.</p></section></main><style data-emotion="css y7pay1">.css-y7pay1{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:1rem;}.css-y7pay1 a{color:var(--theme-ui-colors-secondary);-webkit-text-decoration:none;text-decoration:none;}.css-y7pay1 a:hover{color:var(--theme-ui-colors-heading);-webkit-text-decoration:underline;text-decoration:underline;}.css-y7pay1 a:focus{color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-y7pay1{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 768px){.css-y7pay1{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-y7pay1"><div>© <!-- -->2023<!-- --> by <!-- -->cducrest Blog<!-- -->. All rights reserved.</div><div><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/main/themes/gatsby-theme-minimal-blog" class="css-aizfxq">Theme</a> <!-- -->by<!-- --> <a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de?utm_source=minimal-blog&amp;utm_medium=Theme" class="css-aizfxq">LekoArts</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/olympus-dao-audit-result";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-33e34e260692c3f0d854.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-cd92bbe5e899964d6fc4.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-5ad19931e129db55b7ce.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-about-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-about-index-mdx-421b1f5b1944ea262974.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-blueberry-report-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-blueberry-report-index-mdx-d4adff4125103bff6fc4.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-experience-wrong-interface-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-experience-wrong-interface-index-mdx-bc7e6c6f68b0cea6dff4.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-hats-report-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-hats-report-index-mdx-e10a5c5b73d14658af98.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-olympus-dao-report-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-olympus-dao-report-index-mdx-49d36b98daa9d9d80636.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-67a06325f1eddac62be8.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-5e84ef6f0b172498c730.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-abb9a0d994ab633d7be8.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="3a8ea8038026ec9e89bc";</script><script src="/auditor-blog/webpack-runtime-92c1ce063dfc775037c8.js" async></script><script src="/auditor-blog/framework-f689a2a97f4fb6f27065.js" async></script><script src="/auditor-blog/app-33e34e260692c3f0d854.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>